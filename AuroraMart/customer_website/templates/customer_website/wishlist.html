{% extends 'customer_website/base.html' %}
{% load static %}

{% block title %}My Wishlist - AuroraMart{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'customer_website/css/wishlist.css' %}">
{% endblock %}

{% block content %}
<div class="wishlist-container">
    <div class="wishlist-header">
        <h1><i class="fa-solid fa-heart"></i> My Wishlist</h1>
        <p class="wishlist-count">{{ wishlist_count }} item{{ wishlist_count|pluralize }}</p>
    </div>

    {% if wishlist_items %}
    <div class="wishlist-grid">
        {% for item in wishlist_items %}
        <div class="wishlist-card" data-sku="{{ item.sku }}">
            <a href="?remove_sku={{ item.sku|urlencode }}" class="remove-wishlist-btn" title="Remove from wishlist">
                <i class="fa-solid fa-times"></i>
            </a>
            
            <a href="{% url 'product_detail' item.sku %}?currency={{ selected_currency }}" class="wishlist-product-link">
                <div class="wishlist-product-image">
                    {% if item.product_image %}
                        <img src="{{ item.product_image }}" alt="{{ item.product_name }}">
                    {% else %}
                        <div class="image-placeholder">
                            <i class="fa-solid fa-image"></i>
                        </div>
                    {% endif %}
                </div>
                
                <div class="wishlist-product-info">
                    <h3 class="product-name">{{ item.product_name }}</h3>
                    
                    <div class="product-rating">
                        <div class="stars-small">
                            {% for i in "12345" %}
                                {% if forloop.counter <= item.product_rating %}
                                    <i class="fa-solid fa-star"></i>
                                {% else %}
                                    <i class="fa-regular fa-star"></i>
                                {% endif %}
                            {% endfor %}
                        </div>
                        <span class="rating-value">{{ item.product_rating }}</span>
                    </div>
                    
                    <p class="product-description">{{ item.description|truncatewords:15 }}</p>
                    
                    <div class="product-price-section">
                        <p class="product-price">{{ currency_symbol }}{{ item.unit_price }}</p>
                        
                        {% if item.quantity_on_hand > 0 %}
                            <span class="stock-status in-stock">
                                <i class="fa-solid fa-check-circle"></i> In Stock
                            </span>
                        {% else %}
                            <span class="stock-status out-of-stock">
                                <i class="fa-solid fa-times-circle"></i> Out of Stock
                            </span>
                        {% endif %}
                    </div>
                
                    
                </div>
            </a>
            
            <div class="wishlist-card-actions">
                <a href="{% url 'product_detail' item.sku %}?currency={{ selected_currency }}" class="btn btn-primary">
                    <i class="fa-solid fa-eye"></i> View Product
                </a>
                {% if item.quantity_on_hand > 0 %}
                    {% if item.sku in cart_skus %}
                        <div class="btn btn-success">
                            <i class="fa-solid fa-check-circle"></i> Item in Cart
                        </div>
                    {% else %}
                        <button class="btn btn-secondary" onclick="addToCartFromWishlist('{{ item.sku }}')">
                            <i class="fa-solid fa-cart-plus"></i> Add to Cart
                        </button>
                    {% endif %}
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-wishlist">
        <div class="empty-wishlist-icon">
            <i class="fa-regular fa-heart"></i>
        </div>
        <h2>Your wishlist is empty</h2>
        <p>Start adding products you love to your wishlist!</p>
        <a href="{% url 'all_products' %}" class="btn btn-primary">
            <i class="fa-solid fa-shopping-bag"></i> Browse Products
        </a>
    </div>
    {% endif %}
</div>
<script src="{% static 'customer_website/script/wishlist.js' %}"></script>
{% endblock %}
