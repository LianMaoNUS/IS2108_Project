{% extends 'customer_website/base.html' %}
{% load static %}

{% block title %}AuroraMart - Homepage{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'customer_website/css/main_page.css' %}">
{% endblock %}

{% block content %}
    <header class="hero">
        <div class="hero-slideshow">
            <div class="hero-slide active"
                style="background-image: url('https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');">
                <div class="hero-content">
                    <h2>Welcome back, {{username}}!</h2>
                    <p>We got some products we hope you'll like today!</p>
                    <a href="{% if main_category %}#recommendations{% else %}#top-products{% endif %}" class="btn btn-primary">{% if main_category %}See recommendations{% else %}Browse products{% endif %}</a>
                </div>
            </div>

            <div class="hero-slide"
                style="background-image: url('https://images.unsplash.com/photo-1472851294608-062f824d29cc?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');">
                <div class="hero-content">
                    <h2>Discover Amazing Products</h2>
                    <p>Explore our curated collection of premium items</p>
                    <a href="{% url 'all_products' %}" class="btn btn-primary">Shop Now</a>
                </div>
            </div>

            <div class="hero-slide"
                style="background-image: url('https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&auto=format&fit=crop&w=2340&q=80');">
                <div class="hero-content">
                    <h2>Special Offers</h2>
                    <p>Don't miss out on our limited-time deals</p>
                    <a href="{% url 'profile' %}#coupons" class="btn btn-primary">View Discounts</a>
                </div>
            </div>
        </div>

        <div class="hero-nav">
            <button class="hero-nav-btn prev" onclick="changeSlide(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="hero-nav-btn next" onclick="changeSlide(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <div class="hero-indicators">
            <span class="indicator active" onclick="currentSlide(1)"></span>
            <span class="indicator" onclick="currentSlide(2)"></span>
            <span class="indicator" onclick="currentSlide(3)"></span>
        </div>
    </header>

    <main>
        {% if main_category %}
        <section id="recommendations" class="product-section">

            <div class="section-header">

                <h2>Recommended for you</h2>

                <div class="nav-arrows">

                    <span class="arrow" id="scroll-left">&lt;</span>

                    <span class="arrow" id="scroll-right">&gt;</span>

                </div>

            </div>

            <div class="recommendation-explanation">
                <i class="fas fa-lightbulb"></i>
                <p>We recommend these items because {{ recommendation_reason }}</p>
            </div>

            <div class="product-grid-horizontal" id="product-grid">

                {% for product in products %}

                <div class="product-card">

                    <div class="product-image-placeholder">
                        <img src="{{ product.product_image  }}" alt="{{ product.product_name }}" class="product-image">
                    </div>

                    <div class="product-content">
                        <div class="product-info">
                            <h3>{{ product.product_name }}</h3>
                            <p class="product-desc">{{ product.description|truncatewords:10 }}</p>
                            <div class="product-meta">
                                <span class="product-sku">SKU: {{ product.sku }}</span>
                            </div>
                            <div class="product-price">
                                <span class="currency-symbol">{{ currency_symbol }}</span>
                                <span class="price-amount">{{ product.unit_price }}</span>
                                <span class="product-rating-inline" title="Rating: {{ product.product_rating }}">
                                    <i class="fa-solid fa-star" style="color: #f5c518; margin-left:8px;"></i>
                                    <span class="rating-text" style="margin-left:4px;">{{ product.product_rating }}/5.0</span>
                                </span>
                            </div>
                            <div class="product-actions">
                                <a href="{% url 'product_detail' product.sku %}" class="btn btn-secondary">View</a>
                            </div>
                        </div>
                    </div>

                </div>

                {% endfor %}

            </div>

        </section>
        {% endif %}
                <section id="top-products" class="product-section">
            <div class="section-header">
                <h2>Top Products</h2>
                <div class="nav-arrows">
                    <span class="arrow" id="scroll-left-top">&lt;</span>
                    <span class="arrow" id="scroll-right-top">&gt;</span>
                </div>
            </div>

            <div class="product-grid-horizontal" id="top-product-grid">

                {% for product in top_products %}

                <div class="product-card">

                    <div class="product-image-placeholder">
                        <img src="{{ product.product_image }}" alt="{{ product.product_name }}" class="product-image">
                    </div>

                    <div class="product-content">
                        <div class="product-info">
                            <h3>{{ product.product_name }}</h3>
                            <p class="product-desc">{{ product.description|truncatewords:10 }}</p>
                            <div class="product-meta">
                                <span class="product-sku">SKU: {{ product.sku }}</span>
                            </div>
                            <div class="product-price">
                                <span class="currency-symbol">{{ currency_symbol }}</span>
                                <span class="price-amount">{{ product.unit_price }}</span>
                                <span class="product-rating-inline" title="Rating: {{ product.product_rating }}">
                                    <i class="fa-solid fa-star" style="color: #f5c518; margin-left:8px;"></i>
                                    <span class="rating-text" style="margin-left:4px;">{{ product.product_rating }}/5.0</span>
                                </span>
                            </div>
                            <div class="product-actions">
                                <a href="{% url 'product_detail' product.sku %}" class="btn btn-secondary">View</a>
                            </div>
                        </div>
                    </div>

                </div>

                {% endfor %}

            </div>

        </section>

        <section class="category-section">

            <h2>Browse categories</h2>

            <div class="category-grid">

                {% for category in main_category %}

                <a href="{% url 'all_products' %}?category={{ category.category_id }}" class="category-link">
                    <div class="category-card" data-category-index="{{ forloop.counter0 }}">
                        <div class="category-image-placeholder"></div>
                        <h3>{{ category.name }}</h3>
                    </div>
                </a>

                {% endfor %}

                {% for category in more_categories %}

                <a href="{% url 'all_products' %}?category={{ category.category_id }}" class="category-link">
                    <div class="category-card" data-category-index="{{ forloop.counter0|add:main_category.count }}">
                        <div class="category-image-placeholder"></div>
                        <h3>{{ category.name }}</h3>
                    </div>
                </a>

                {% endfor %}

            </div>

        </section>

    </main>
{% endblock %}

{% block bottom_js %}
<script src="{% static 'customer_website/script/main_page.js' %}"></script>
{% endblock %}